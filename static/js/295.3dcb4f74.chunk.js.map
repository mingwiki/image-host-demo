{"version":3,"file":"static/js/295.3dcb4f74.chunk.js","mappings":"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","sources":["components/Uploader.jsx","components/Tips.jsx","pages/Home.jsx"],"sourcesContent":["import React, { useState, useContext } from \"react\";\nimport context from \"../stores/index\";\nimport { observer } from \"mobx-react\";\nimport { Upload, Modal, message } from \"antd\";\nimport { PlusOutlined } from \"@ant-design/icons\";\nimport styled from \"styled-components\";\n\nconst Wrapper = styled.div`\n  margin: 2em;\n`;\nconst UploadResultHeader = styled.div`\n  font-size: 1.5em;\n  margin: 2em;\n  padding: 0 2em;\n  text-align: center;\n  border: 1px solid;\n  border-radius: 10px;\n`;\nconst UploadResult = styled.div`\n  border: 4px groove;\n  border-top: none;\n  border-radius: 1em;\n  padding: 1em 3em;\n`;\nconst UploadResultLine = styled.div`\n  display: flex;\n  justify-content: space-between;\n  margin: 0.5em 0;\n  padding: 0 1em;\n`;\nconst Copy = styled.button`\n  border-style: solid;\n  background: none;\n  cursor: pointer;\n  &.active {\n    border-style: dashed;\n  }\n  &:active {\n    color: red;\n  }\n`;\n\nconst Component = observer(() => {\n  const { ImageStore, UserStore } = useContext(context);\n  const [previewVisible, setPreviewVisible] = useState(false);\n  const [previewImage, setPreviewImage] = useState(\"\");\n  const [previewTitle, setPreviewTitle] = useState(\"\");\n  const [fileList, setFilelist] = useState([]);\n\n  let onCancel = () => setPreviewVisible(false);\n  let onPreview = (file) => {\n    setPreviewImage(file.url);\n    setPreviewVisible(true);\n    setPreviewTitle(\n      file.name || file.url.substring(file.url.lastIndexOf(\"/\") + 1)\n    );\n  };\n  let onRemove = (file) => {\n    setFilelist(fileList.filter((v) => v !== file));\n  };\n\n  // let customRequest = async ({ file }) => {\n  //   ImageStore.setFile(file);\n  //   ImageStore.setName(file.name);\n  //   if (!UserStore.currentUser) {\n  //     message.error(\"请先登录再上传\");\n  //     return;\n  //   }\n  //   try {\n  //     let img = await ImageStore.upload();\n  //     setFilelist((fileList) => [\n  //       ...fileList,\n  //       {\n  //         uid: file.uid,\n  //         name: file.name,\n  //         status: \"done\",\n  //         url: img.attributes.attachments[0].attributes.url,\n  //       },\n  //     ]);\n  //     console.log(\"文件上传成功\");\n  //   } catch (err) {\n  //     setFilelist((fileList) => [\n  //       ...fileList,\n  //       {\n  //         uid: file.uid,\n  //         name: file.name,\n  //         status: \"error\",\n  //       },\n  //     ]);\n  //     console.log(\"文件上传失败\", err);\n  //   }\n  // };\n  let customRequest = ({ file }) => {\n    ImageStore.setFile(file);\n    ImageStore.setName(file.name);\n    if (!UserStore.currentUser) {\n      message.error(\"请先登录再上传\");\n      return;\n    }\n    ImageStore.upload().then(\n      (img) => {\n        setFilelist((fileList) => [\n          ...fileList,\n          {\n            uid: file.uid,\n            name: file.name,\n            status: \"done\",\n            url: img.attributes.attachments[0].attributes.url,\n          },\n        ]);\n        console.log(\"文件上传成功\");\n      },\n      (err) => {\n        setFilelist((fileList) => [\n          ...fileList,\n          {\n            uid: file.uid,\n            name: file.name,\n            status: \"error\",\n          },\n        ]);\n        console.log(\"文件上传失败\", err);\n      }\n    );\n  };\n\n  const uploadButton = (\n    <div>\n      <PlusOutlined />\n      <div style={{ marginTop: 8 }}>Upload</div>\n    </div>\n  );\n  return (\n    <Wrapper>\n      <Upload\n        listType=\"picture-card\"\n        fileList={fileList}\n        onPreview={onPreview}\n        onRemove={onRemove}\n        customRequest={customRequest}\n        multiple={true}\n      >\n        {uploadButton}\n      </Upload>\n      {fileList.length === 0 ? null : (\n        <>\n          <UploadResultHeader>上传结果</UploadResultHeader>\n          <UploadResult>\n            {fileList.map((file) => (\n              <UploadResultLine key={file.uid}>\n                <a href={file.url} target=\"_blank\" rel=\"noreferrer\">\n                  {file.name}\n                </a>\n                <Copy\n                  onClick={(e) => {\n                    if (file.url) {\n                      navigator.clipboard.writeText(file.url);\n                      e.target.innerText = \"(链接已复制)\";\n                    } else {\n                      navigator.clipboard.writeText(file.name);\n                      e.target.innerText = \"(文件名已复制)\";\n                    }\n                    if (\n                      !e.target.className\n                        .toString()\n                        .split(\" \")\n                        .includes(\"active\")\n                    ) {\n                      e.target.className += \" active\";\n                    }\n                  }}\n                >\n                  {file.url ? \"点击复制链接\" : \"上传失败，点击复制文件名\"}\n                </Copy>\n              </UploadResultLine>\n            ))}\n          </UploadResult>\n        </>\n      )}\n      <Modal\n        visible={previewVisible}\n        title={previewTitle}\n        footer={null}\n        onCancel={onCancel}\n      >\n        <img alt=\"example\" style={{ width: \"100%\" }} src={previewImage} />\n      </Modal>\n    </Wrapper>\n  );\n});\n\nexport default Component;\n","import React, { useContext } from \"react\";\nimport context from \"../stores/index\";\nimport { observer } from \"mobx-react\";\nimport styled from \"styled-components\";\n\nconst Tips = styled.div`\n  padding: 1em 2em;\n  font-size: 1.2rem;\n  text-align: center;\n`;\nconst RedTips = styled.div`\n  color: red;\n  padding: 1em 2em;\n  font-size: 1.2rem;\n  text-align: center;\n`;\nconst Component = observer(({ children }) => {\n  const { UserStore } = useContext(context);\n  return UserStore.currentUser ? (\n    <Tips>欢迎回来， {UserStore.currentUser.attributes.username}</Tips>\n  ) : (\n    <RedTips>请先登录再上传, {children}</RedTips>\n  );\n});\nexport default Component;\n","import React from \"react\";\n// import context from \"../stores/index.jsx\";\nimport { observer } from \"mobx-react\";\nimport Uploader from \"../components/Uploader\";\nimport Tips from \"../components/Tips\";\nconst Component = observer(() => {\n  // const { UserStore } = useContext(context);\n  return (\n    <main>\n      <Tips>用户未登录</Tips>\n      <Uploader />\n    </main>\n  );\n});\n\nexport default Component;\n"],"names":["Wrapper","styled","UploadResultHeader","UploadResult","UploadResultLine","Copy","observer","useContext","context","ImageStore","UserStore","useState","previewVisible","setPreviewVisible","previewImage","setPreviewImage","previewTitle","setPreviewTitle","fileList","setFilelist","uploadButton","PlusOutlined","style","marginTop","listType","onPreview","file","url","name","substring","lastIndexOf","onRemove","filter","v","customRequest","setFile","setName","currentUser","upload","then","img","uid","status","attributes","attachments","console","log","err","message","multiple","length","map","href","target","rel","onClick","e","navigator","clipboard","writeText","innerText","className","toString","split","includes","visible","title","footer","onCancel","alt","width","src","Tips","RedTips","children","username","Uploader"],"sourceRoot":""}